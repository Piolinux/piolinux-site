<script>
function generateBackupCommand() {
    const type = document.getElementById('backupType').value;
    const source = document.getElementById('sourcePath').value.trim();
    const dest = document.getElementById('destPath').value.trim();
    let command = '';
    let explanation = '';
    let warning = '';

    switch (type) {
        case 'tar':
            if (source && dest) {
                command = `tar -czvf ${dest} ${source}`;
                explanation = `# -c: criar arquivo | -z: gzip | -v: verbose | -f: nome do arquivo`;
                warning = '💡 Dica: Adicione --exclude="*.log" para ignorar logs.';
            } else {
                command = '❌ Preencha origem e destino';
            }
            break;
        case 'rsync':
            if (source && dest) {
                command = `rsync -avz --progress ${source}/ ${dest}/`;
                explanation = `# -a: archive (preserva permissões) | -v: verbose | -z: compressão`;
                warning = '⚠️ Teste com --dry-run primeiro!';
            } else {
                command = '❌ Preencha origem e destino';
            }
            break;
        case 'dd':
            if (source && dest) {
                command = `dd if=${source} of=${dest} bs=4M status=progress`;
                explanation = `# if: input file | of: output file | bs: block size | status: progresso`;
                warning = '🚨 CUIDADO: dd apaga dados se usado incorretamente!';
            } else {
                command = '❌ Preencha origem e destino';
            }
            break;
        case 'mysqldump':
            if (dest) {
                command = `mysqldump -u [usuario] -p [banco] > ${dest}`;
                explanation = `# -u: usuário | -p: pede senha | >: redireciona saída`;
                warning = '🔐 Nunca exponha senhas: use ~/.my.cnf para autenticação segura.';
            } else {
                command = '❌ Preencha destino';
            }
            break;
    }

    // Atualiza interface
    document.getElementById('backupResult').innerHTML = `
        <div style="font-family: monospace; font-size: 1.1em; color: #8bc34a; margin-bottom: 8px;">
            ${command}
        </div>
        ${explanation ? `<div style="font-size: 0.9em; color: #aaa; margin-bottom: 8px;">${explanation}</div>` : ''}
        ${warning ? `<div style="font-size: 0.9em; color: #ffcc00; font-weight: bold;">${warning}</div>` : ''}
    `;
}

function copyBackupCommand() {
    const text = document.getElementById('backupResult').innerText;
    if (text && !text.includes('❌')) {
        navigator.clipboard.writeText(text.split('\n')[0]).then(() => {
            alert('✅ Comando copiado!');
        }).catch(() => {
            alert('❌ Falha ao copiar. Tente manualmente.');
        });
    }
}
</script>
